
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.3">
    
    
      
        <title>资料汇总 - 2021龙芯杯</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="2021龙芯杯" class="md-header__button md-logo" aria-label="2021龙芯杯" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            2021龙芯杯
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              资料汇总
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="2021龙芯杯" class="md-nav__button md-logo" aria-label="2021龙芯杯" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    2021龙芯杯
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        首页
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          资料汇总
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        资料汇总
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    阅读须知
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    参考资料
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    常见问题
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    器件名称表
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    拓展内容
  </a>
  
    <nav class="md-nav" aria-label="拓展内容">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    指令集
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    版本控制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    部件资料
  </a>
  
    <nav class="md-nav" aria-label="部件资料">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icache" class="md-nav__link">
    ICache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    分支预测器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    发射队列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcache" class="md-nav__link">
    DCache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#store-buffer" class="md-nav__link">
    Store Buffer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l2-cache" class="md-nav__link">
    L2 Cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    乘除法器件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fu" class="md-nav__link">
    访存FU
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    硬件栈
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    数据旁路
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    寄存器文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tlb" class="md-nav__link">
    TLB
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    策略
  </a>
  
    <nav class="md-nav" aria-label="策略">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    组相联结构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-code" class="md-nav__link">
    预解码（pre-code）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cache" class="md-nav__link">
    流水线Cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#victim-cache" class="md-nav__link">
    victim cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefetching" class="md-nav__link">
    预取（prefetching）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scoreboard" class="md-nav__link">
    ScoreBoard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lru" class="md-nav__link">
    伪LRU替换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    交叠实现多端口
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    拓展资料
  </a>
  
    <nav class="md-nav" aria-label="拓展资料">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    完整的分支预测
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cache_1" class="md-nav__link">
    Cache布局图：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../CPU%E8%AE%BE%E8%AE%A1/" class="md-nav__link">
        CPU设计
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Cache%E8%AE%BE%E8%AE%A1/" class="md-nav__link">
        Cache设计
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Soc%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1/" class="md-nav__link">
        Soc框架设计
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../%E5%A4%96%E8%AE%BE%E9%83%A8%E5%88%86%E8%AE%BE%E8%AE%A1/" class="md-nav__link">
        外设设计
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        其它资料
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="其它资料" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          其它资料
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../%E8%B6%85%E6%A0%87%E9%87%8F%E5%A4%84%E7%90%86%E5%99%A8%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        《超标量处理器》笔记
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../materials/%E6%8C%87%E4%BB%A4%E9%9B%86/" class="md-nav__link">
        指令集
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../materials/%E6%94%AF%E6%8C%81%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%A2%9D%E5%A4%96%E6%8C%87%E4%BB%A4/" class="md-nav__link">
        支持操作系统的额外指令
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    阅读须知
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    参考资料
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    常见问题
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    器件名称表
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    拓展内容
  </a>
  
    <nav class="md-nav" aria-label="拓展内容">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    指令集
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    版本控制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    部件资料
  </a>
  
    <nav class="md-nav" aria-label="部件资料">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#icache" class="md-nav__link">
    ICache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    分支预测器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    发射队列
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcache" class="md-nav__link">
    DCache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#store-buffer" class="md-nav__link">
    Store Buffer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l2-cache" class="md-nav__link">
    L2 Cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    乘除法器件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fu" class="md-nav__link">
    访存FU
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    硬件栈
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    数据旁路
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    寄存器文件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tlb" class="md-nav__link">
    TLB
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    策略
  </a>
  
    <nav class="md-nav" aria-label="策略">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    组相联结构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-code" class="md-nav__link">
    预解码（pre-code）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cache" class="md-nav__link">
    流水线Cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#victim-cache" class="md-nav__link">
    victim cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefetching" class="md-nav__link">
    预取（prefetching）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scoreboard" class="md-nav__link">
    ScoreBoard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lru" class="md-nav__link">
    伪LRU替换
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    交叠实现多端口
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    拓展资料
  </a>
  
    <nav class="md-nav" aria-label="拓展资料">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    完整的分支预测
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cache_1" class="md-nav__link">
    Cache布局图：
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="_1">龙芯杯资料汇总<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<blockquote>
<p>2021/6/11</p>
<p>此文档是我们小组从各个地方汇总的资料，为我们实现的架构作参考</p>
</blockquote>
<p><br></p>
<h3 id="_2">阅读须知<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<ul>
<li>此文档是我们小组正在参加的“龙芯杯”比赛的文档，后续会进一步更新</li>
<li>==黄色标记部分==表明此处最近在更新</li>
<li>实现细节中相对复杂的策略单独列了一个**策略栏**来阐释</li>
</ul>
<p><br></p>
<h3 id="_3">参考资料<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<ol>
<li><a href="../materials/%E8%B6%85%E6%A0%87%E9%87%8F%E5%A4%84%E7%90%86%E5%99%A8.pdf">超标量处理器设计</a></li>
<li><a href="../materials/19%E5%B9%B4%E9%BE%99%E8%8A%AF%E6%9D%AF%E6%B8%85%E5%8D%8E%E9%98%9F%E5%86%B3%E8%B5%9B%E6%8A%A5%E5%91%8A.pdf">19年龙芯杯清华队决赛报告</a></li>
<li>复旦大学<code>FDU1.1</code>队在第四届“龙芯杯”的<a href="https://github.com/NSCSCC-2020-Fudan/FDU1.1-NSCSCC/">参赛作品</a></li>
<li>薛振梁助教的<code>PPT</code>：<a href="materials\ICS Final Project Topics.pdf">ICS Final Project Topics</a>、<a href="materials\ram-on-fpga.pdf">RAM on FPGA</a></li>
<li>谭一凡助教写的<code>labs</code>：<a href="https://github.com/Tan-YiFan/ICS-2021Spring-FDU/tree/test_linux">github网页</a></li>
</ol>
<p><br></p>
<h3 id="_4">常见问题<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<ol>
<li>龙芯杯的top文件需要自己写吗？</li>
</ol>
<blockquote>
<p>本学期的top文件实例化了一个龙芯杯的top，可以参考那个。</p>
</blockquote>
<ol>
<li>双发流水线如何进行golden trace的比对？</li>
<li>操作系统进程切换的时候需要我们保存处理器状态吗？</li>
<li><code>linux</code>仿真</li>
<li>功能测试需要异常处理吗？</li>
</ol>
<p><br></p>
<h3 id="_5"><mark>器件名称表</mark><a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>缩写</th>
<th>全称</th>
<th>意思</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>BIT</td>
<td>Branch Instruction Table</td>
<td>分支指令表</td>
<td>用PC预测是否是分支指令</td>
</tr>
<tr>
<td>BB</td>
<td>Branch Buffer</td>
<td>分支暂存器</td>
<td>保存当前分支的信息，以等待延迟槽的取来</td>
</tr>
<tr>
<td>PHT</td>
<td>Pattern History Table</td>
<td>跳转历史表</td>
<td>用以前的跳转记录来判断当前的跳转</td>
</tr>
<tr>
<td>BTB</td>
<td>Branch Target Buffer</td>
<td>跳转地址缓存</td>
<td>预测跳转的地址</td>
</tr>
<tr>
<td>RAS</td>
<td>Return Address Stack</td>
<td>返回地址栈</td>
<td>充当函数调用和返回的硬件栈</td>
</tr>
<tr>
<td>ICache</td>
<td>Instruction Cache</td>
<td>指令Cache</td>
<td>缓存内存到CPU的指令</td>
</tr>
<tr>
<td>DCache</td>
<td>Data Cache</td>
<td>数据Cache</td>
<td>缓存内存到CPU的数据</td>
</tr>
<tr>
<td>FU</td>
<td>functional unit</td>
<td>计算单元</td>
<td>在执行阶段计算数据</td>
</tr>
<tr>
<td>CPU</td>
<td>central processing unit</td>
<td>中央处理器</td>
<td>处理所有的指令</td>
</tr>
<tr>
<td>TLB</td>
<td>translation lookaside buffer</td>
<td>转移后备缓冲区</td>
<td>缓存虚拟地址和其映射的物理地址</td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="_6">拓展内容<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<h4 id="_7">指令集<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<ul>
<li>需要实现的指令: <a href="materials\指令集.md">普通部分</a>、<a href="materials\支持操作系统的额外指令.md">外设部分</a></li>
<li>CLO和CLZ可以共用一套硬件电路，但是就不能同时处理两条指令了</li>
</ul>
<h4 id="_8"><mark>版本控制</mark><a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<ul>
<li>github actions自动化测试和部署：自动部署网站和用verilator测试</li>
<li>git模块处理：git submodule</li>
</ul>
<p><br></p>
<h3 id="_9">部件资料<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<h4 id="icache">ICache<a class="headerlink" href="#icache" title="Permanent link">&para;</a></h4>
<ul>
<li>组相连结构、流水线Cache、多端口读取（Mult-banking）、预解码、硬件预取、victim Cache、伪LRU替换策略</li>
<li>Cache布局图：详见拓展资料（Cache布局图）</li>
<li>
<p>取值方式：两种方式，目前倾向于用第一种：（1）每次从当前地址开始往后取满一个cacheline，判断逻辑在流水线阶段完成（详见流水线取指逻辑）（2）从当前地址开始往后取两条或三条指令，取决于第二条指令是否是分支指令</p>
</li>
<li>
<p>一个cacheline中有跳转指令：若该指令跳转，则延迟槽之后的指令不应该执行</p>
</li>
<li>cacheline最后一条指令为跳转指令：则必须取完下一条cacheline后再判断分支指令，用流水线控制逻辑处理</li>
<li><mark>cacheline有两条分支指令</mark></li>
<li>其它细节问题：每周期只能访问一个cacheline</li>
</ul>
<h4 id="_10">分支预测器<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<ul>
<li>完整的分支预测：详见拓展资料（完整的分支预测）</li>
<li>折中的分支预测：分支预测只针对间接跳转指令（寄存器跳转），其它跳转指令（Call、return或PC直接跳转）在接收到ICache返回的指令后快速进行判断。</li>
<li>其它的细节问题：（1）BIT和CPHT数量的差别：与跳转指令的占比有关（2）由于BIT的存在，BTB不设置tag，所以不会缺失（除了一开始的强制缺失）</li>
</ul>
<h4 id="_11">发射队列<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<ul>
<li>双队列交叠（考虑了硬件，其实没必要）、两个读端口和几个写端口</li>
<li><mark>几个写端口</mark>：不管怎么样，都需要用控制逻辑处理分支指令和延迟槽的问题。（1）四个写端口：紧凑但是浪费硬件（<del>其实无所谓</del>，咱们写代码的），因为后续的双发是瓶颈（2）三个写端口：双队列交叠可能就不方便了，专门处理MIPS指令中的分支指令+延迟槽（19年清华大学队）（3）两个写端口：朴实无华（20年复旦大学队）</li>
<li>发射队列怎么判断哪些位置是有效的：<mark>用索引或有效位遍历</mark></li>
<li>队列满：流水线暂停或当前指令重取</li>
</ul>
<h4 id="dcache">DCache<a class="headerlink" href="#dcache" title="Permanent link">&para;</a></h4>
<ul>
<li>组相连结构、流水线、<mark>单端口读写</mark>、回写（write back）、写缓存（write buffer）、victim cache、伪LRU替换策略</li>
<li>根据 MIPS标准要求，对于不同段的访存，数据缓存行为不同：（1）<strong>kseg3/ksseg</strong> 按 TLB 判断是否经过缓存（2）<strong>kseg1</strong> 不经过缓存（3）<strong>kseg0</strong> 可由 CP0 ConfigK0 寄存器控制，MIPS 标准中这一行为的实现可选（4）<strong>useg</strong> 按 TLB 判断是否经过缓存</li>
<li>单端口读写：只有一个访存单元，而且这样可以简化DCache的逻辑，<del>当然写Cache的人想多端口也没问题</del>​​，这样就需要两个访存单元了</li>
<li>采用回写策略（write back）：脏数据被替换的时候才写回</li>
<li>写缓存（write buffer）：写回时写到缓存中，等总线空闲的时候再写缓存再写到内存中，不过Cache缺失时，需要先在写缓存里找，判断是否在其中。</li>
<li>流水线访问：先写后读冲突，用Delayed Store Addr和Delayed Store Data寄存器解决，类似于转发</li>
</ul>
<h4 id="store-buffer">Store Buffer<a class="headerlink" href="#store-buffer" title="Permanent link">&para;</a></h4>
<ul>
<li>这个器件跟整体的设计有关，如果能保证执行阶段store正确性的话可以不要</li>
<li>store指令计算完后放在这里，直到退休（retire）才真正写回DCache，这样的话load指令需要先从Store Buffer里找对应的指令</li>
</ul>
<h4 id="l2-cache">L2 Cache<a class="headerlink" href="#l2-cache" title="Permanent link">&para;</a></h4>
<ul>
<li>单端口</li>
</ul>
<h4 id="_12">乘除法器件<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h4>
<ul>
<li>一个乘法器和一个除法器（考虑到MIPS乘除法指令之间会有移动Hi、Lo的指令，所以不太可能两条乘/除法连在一起），若连续两条乘除法指令，则只发射第一条</li>
</ul>
<h4 id="fu">访存FU<a class="headerlink" href="#fu" title="Permanent link">&para;</a></h4>
<ul>
<li>设置一个（连续两条指令为load的可能性很小，没有必要为此增加大量的硬件），若同时有两条load指令，则只发射第一条。</li>
</ul>
<h4 id="_13">硬件栈<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<ul>
<li>RAS(Return Address Stack)：带计数器的栈，解决自己调用自己的递归问题。</li>
</ul>
<h4 id="_14"><mark>数据旁路</mark><a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<ul>
<li>ScoreBoard</li>
</ul>
<h4 id="_15"><mark>寄存器文件</mark><a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<ul>
<li>四个读端口、两个写端口、Hi和Lo寄存器（特判）</li>
</ul>
<h4 id="tlb"><mark>TLB</mark><a class="headerlink" href="#tlb" title="Permanent link">&para;</a></h4>
<p><br></p>
<h3 id="_16">策略<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<h5 id="_17"><mark>组相联结构</mark><a class="headerlink" href="#_17" title="Permanent link">&para;</a></h5>
<h5 id="pre-code">预解码（pre-code）<a class="headerlink" href="#pre-code" title="Permanent link">&para;</a></h5>
<ul>
<li>解释：ICache获取内存的数据的时，判断其是否是分支指令，并将结果另外保存在ICache中</li>
</ul>
<h5 id="cache">流水线Cache<a class="headerlink" href="#cache" title="Permanent link">&para;</a></h5>
<ul>
<li>解释：像流水线一样处理Cache，降低时钟频率</li>
</ul>
<p><img alt="对DCache的写操作使用流水线" src="../%E8%B5%84%E6%96%99%E5%9B%BE%E7%89%87/%E5%AF%B9DCache%E7%9A%84%E5%86%99%E6%93%8D%E4%BD%9C%E4%BD%BF%E7%94%A8%E6%B5%81%E6%B0%B4%E7%BA%BF.PNG" /></p>
<h5 id="victim-cache">victim cache<a class="headerlink" href="#victim-cache" title="Permanent link">&para;</a></h5>
<blockquote>
<p>《超标量处理器设计》2.2.4</p>
</blockquote>
<ul>
<li>解释：防止被踢出的数据马上被利用，而与之相对的Filter Cache则是防止不会再用的数据一直不被踢出</li>
</ul>
<p><img alt="victimcache所处的位置" src="../%E8%B5%84%E6%96%99%E5%9B%BE%E7%89%87/victimcache%E6%89%80%E5%A4%84%E7%9A%84%E4%BD%8D%E7%BD%AE.PNG" /></p>
<h5 id="prefetching">预取（prefetching）<a class="headerlink" href="#prefetching" title="Permanent link">&para;</a></h5>
<blockquote>
<p>《超标量处理器设计》2.2.5</p>
</blockquote>
<ul>
<li>
<p>解释：字如其名，提前把额外的数据（当前Cacheline的下几条Cacheline等将来可能会用到的）取好</p>
</li>
<li>
<p>ICache效果比DCache要好，DCache可以不使用预取</p>
</li>
<li>
<p>为了防止预取的数据没有用造成“Cache 污染”，可以将预取的指令放到单独的一个缓存（Stream Buffer）中。（Alpha 21064对指令预取使用的方法）</p>
</li>
</ul>
<p><img alt="对指令采用硬件预取" src="../%E8%B5%84%E6%96%99%E5%9B%BE%E7%89%87/%E5%AF%B9%E6%8C%87%E4%BB%A4%E9%87%87%E7%94%A8%E7%A1%AC%E4%BB%B6%E9%A2%84%E5%8F%96.PNG" /></p>
<h5 id="scoreboard">ScoreBoard<a class="headerlink" href="#scoreboard" title="Permanent link">&para;</a></h5>
<blockquote>
<p>《超标量处理器设计》1.3.1</p>
</blockquote>
<ul>
<li>解释：用来转发、旁路的表格，保存正在计算的寄存器相关数据在哪里</li>
<li>P：Pending，表示结果还没有写回到寄存器中</li>
<li>F：在那个FU中执行，转发时会用到这个信息</li>
<li>Result Position：记录到达FU流水线的哪个阶段，每个周期右移一位，不同指令的转发条件不同。</li>
</ul>
<p><img alt="一个典型的ScoreBoard" src="../%E8%B5%84%E6%96%99%E5%9B%BE%E7%89%87/%E4%B8%80%E4%B8%AA%E5%85%B8%E5%9E%8B%E7%9A%84ScoreBoard.PNG" /></p>
<h5 id="lru">伪LRU替换<a class="headerlink" href="#lru" title="Permanent link">&para;</a></h5>
<blockquote>
<p>《超标量处理器设计》2.1.3</p>
</blockquote>
<ul>
<li>解释：LRU（least recently used），把最晚使用的Cacheline替换出去</li>
</ul>
<p><img alt="伪LRU算法的工作流程" src="../%E8%B5%84%E6%96%99%E5%9B%BE%E7%89%87/%E4%BC%AALRU%E7%AE%97%E6%B3%95%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B.PNG" /></p>
<h5 id="_18">交叠实现多端口<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h5>
<ul>
<li>是一种思想</li>
<li>实现：简单的说就是一整块东西拆成多块，然后不同的块可以同时输出，而不用真的在一块上实现多端口。</li>
<li>考虑硬件：通常的多端口需要大量资源，交叠可以节省硬件资源（<del>不过对于我们来说没啥用</del>）</li>
<li>可以应用的部件：ICache、发射队列、寄存器文件等等</li>
</ul>
<h3 id="_19">拓展资料<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<h4 id="_20">完整的分支预测<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h4>
<blockquote>
<p>Alpha 21264</p>
</blockquote>
<p>在取指阶段预测该指令：</p>
<ol>
<li>
<p>是否是分支指令：用PC的部分索引BIT（branch instruction table）                 （1）是否是CALL指令（jal、bal）：利用BTB（branch target buffer）中存放的额外信息，若是，则把当前PC+8的值（有延迟槽）压入带计数器的RAS（Return Address Stack）（2）是否是Return（jr）：利用BTB中存放额外信息，若是，把RAS中的栈顶元素作为预测的地址</p>
</li>
<li>
<p>是否会跳转：采用竞争的分支预测（1）GHR（global history register）：记录所有跳转指令的跳转情况（2）BHT（branch history table）：记录局部跳转指令的跳转情况（3）PHTs（pattern history table）：两位的**饱和计数器**表格（4）CPHT（choice PHT）：根据PC和GHR里的值来选择使用哪一个分支预测的结果。</p>
</li>
<li>
<p>跳转的地址：存放在BTB中</p>
</li>
</ol>
<blockquote>
<p>《超标量处理器设计》4.2.5</p>
</blockquote>
<p><img alt="竞争的分支预测" src="../%E8%B5%84%E6%96%99%E5%9B%BE%E7%89%87/%E7%AB%9E%E4%BA%89%E7%9A%84%E5%88%86%E6%94%AF%E9%A2%84%E6%B5%8B.PNG" /></p>
<p>数据的更新：用预测的结果更新GHR，在分支指令退休的时候更新BHR和PHT中的饱和计数器</p>
<h4 id="cache_1">Cache布局图：<a class="headerlink" href="#cache_1" title="Permanent link">&para;</a></h4>
<blockquote>
<p>2020年龙芯杯复旦大学<code>FDU1.1</code>队</p>
</blockquote>
<p><img alt="Cache设计图-复旦大学FDU1.1队" src="../%E8%B5%84%E6%96%99%E5%9B%BE%E7%89%87/Cache%E8%AE%BE%E8%AE%A1%E5%9B%BE-%E5%A4%8D%E6%97%A6%E5%A4%A7%E5%AD%A6FDU1.1%E9%98%9F.PNG" /></p>
<p><br></p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../.." class="md-footer__link md-footer__link--prev" aria-label="Previous: 首页" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              首页
            </div>
          </div>
        </a>
      
      
        
        <a href="../CPU%E8%AE%BE%E8%AE%A1/" class="md-footer__link md-footer__link--next" aria-label="Next: CPU设计" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              CPU设计
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.29db7785.min.js"></script>
      
    
  </body>
</html>